<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãŠçµµã‹ãã‚¯ã‚¤ã‚º - ãƒãƒ¼ã‚¿ãƒ«</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <style>
        body { background: #0047AB; color: white; font-family: sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; flex-direction: column; }
        .box { background: rgba(255,255,255,0.2); padding: 40px; border-radius: 20px; width: 350px; text-align: center; border: 1px solid rgba(255,255,255,0.3); }
        h1 { margin-bottom: 30px; font-size: 28px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .btn { width: 100%; padding: 20px; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; margin: 10px 0; font-size: 22px; transition: 0.2s; text-decoration: none; display: block; box-sizing: border-box; }
        
        /* éƒ¨å±‹ã«å…¥ã‚‹ï¼ˆé’ç·‘ç³»ï¼‰ */
        .btn-join { background: #2ed573; color: white; }
        .btn-join:active { background: #26af5f; transform: translateY(2px); }
        
        /* éƒ¨å±‹ã‚’ä½œã‚‹ï¼ˆã‚´ãƒ¼ãƒ«ãƒ‰ç³»ï¼‰ */
        .btn-host { background: #ffcc00; color: #333; }
        .btn-host:active { background: #e6b800; transform: translateY(2px); }

        .footer { margin-top: 20px; font-size: 12px; opacity: 0.7; }
    </style>
</head>
<body>

<div class="box">
    <h1>ğŸ¨ ãŠçµµã‹ãã‚¯ã‚¤ã‚º</h1>
    
    <a href="join.html" class="btn btn-join">ã‚ãã³ã«ã„ã</a>
    
    <button class="btn btn-host" onclick="createRoom()">ã¸ã‚„ã‚’ã¤ãã‚‹</button>
</div>

<div class="footer">ãŠçµµã‹ãã‚¯ã‚¤ã‚º v2.0</div>

<script>
    // --- Firebaseè¨­å®šï¼ˆã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§å…±é€šã®ã‚‚ã®ã‚’ä½¿ã£ã¦ãã ã•ã„ï¼‰ ---
    const config = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
        databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.firebaseio.com",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_PROJECT_ID.appspot.com",
        messagingSenderId: "YOUR_ID",
        appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(config);
    const db = firebase.database();

    async function createRoom() {
        const name = prompt("ã‚ãªãŸã®ãªã¾ãˆã‚’ã„ã‚Œã¦ã­");
        if(!name) return;

        // 4ã‚±ã‚¿ã®éƒ¨å±‹ç•ªå·ã‚’ãƒ©ãƒ³ãƒ€ãƒ ä½œæˆ
        const roomID = Math.floor(1000 + Math.random() * 9000);
        // ãƒ›ã‚¹ãƒˆç”¨ã®ç°¡æ˜“UIDã‚’ä½œæˆ
        const uid = "h-" + Math.random().toString(36).substring(2, 7);
        
        // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«éƒ¨å±‹ã‚’åˆæœŸåŒ–
        await db.ref(`rooms/${roomID}`).set({
            state: { 
                phase: 'setup', 
                currentIndex: 0,
                timer: 60
            },
            users: {
                [uid]: { 
                    name: name + "(ãƒ›ã‚¹ãƒˆ)", 
                    score: 0, 
                    image: "" 
                }
            }
        });

        // æƒ…å ±ã‚’ä¿å­˜ã—ã¦è¨­å®šç”»é¢ï¼ˆhost.htmlï¼‰ã¸
        sessionStorage.setItem('quiz_room', roomID);
        sessionStorage.setItem('quiz_uid', uid);
        sessionStorage.setItem('quiz_name', name);
        
        location.href = 'host.html';
    }
</script>
</body>
</html>